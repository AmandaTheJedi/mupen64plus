#summary Temporary launcher used to make Mupen64Plus run on Mac

= Introduction =

Temporary launcher used to make Mupen64Plus run on Mac - see main article about building on mac. To make the launcher, I used this wxWidgets code (I can hear people asking "why not Cocoa?". Well, simply because I don't know Cocoa `^`o`^`)


= Details =

{{{
#include <iostream>
#include "wx/wx.h"
#include "wx/html/webkit.h"
#include "wx/stdpaths.h"

enum
{
    ID_CONFIGURE,
    ID_LAUNCH
};

class QuickBoxLayout
{
    wxBoxSizer* bsizer;
public:
    wxPanel* pane;
    
    QuickBoxLayout(wxWindow* component, wxSizer* parent, int orientation=wxHORIZONTAL)
    {
        pane = new wxPanel(component);
        parent->Add(pane,1);
        bsizer = new wxBoxSizer(orientation);
    }
    void add(wxWindow* window)
    {
        bsizer->Add(window, 1, wxALL, 10);
    }
    ~QuickBoxLayout()
    {
        pane->SetSizer(bsizer);
        bsizer->Layout();
        //bsizer->SetSizeHints(pane);
    }
};


class MyFrame : public wxFrame
{
public:
    MyFrame(wxWindow* ptr, int id, wxString name, wxPoint pos, wxSize size) : wxFrame(ptr,id,name,pos,size)
    {
        wxBoxSizer* bsizer = new wxBoxSizer(wxHORIZONTAL);
        
        wxString filepath = wxT("file://") + wxStandardPaths::Get().GetResourcesDir() + wxT("/") + wxT("beta_msg.htm") ;
        filepath.Replace(wxT(" "), wxT("%20"));
        
        wxWebKitCtrl* html = new wxWebKitCtrl(this, wxID_ANY, filepath );
        bsizer->Add( html, 2, wxEXPAND );
        
        {
        QuickBoxLayout rightPane(this, bsizer, wxVERTICAL);
        rightPane.add( new wxButton( rightPane.pane, ID_CONFIGURE, _("Configure mupen64plus") ) );
        rightPane.add( new wxButton( rightPane.pane, ID_LAUNCH, _("Play rom") ) );
        }
        
        SetSizer(bsizer);
        Layout();
        
        Center();
        Show();
    }
    void onConfigureClicked(wxCommandEvent& evt)
    {
        wxExecute( wxStandardPaths::Get().GetResourcesDir()+wxT("/../MacOS/mupen64plus") );
    }
    void onLaunchClicked(wxCommandEvent& evt)
    {
        wxString filename = wxFileSelector( wxT("Choose a N64 ROM file") );
        if ( !filename.empty() )
        {
            wxString cmd = wxT("\"") + wxStandardPaths::Get().GetResourcesDir() + wxT("/../MacOS/mupen64plus\" --nogui \"") + filename + wxT("\"");
            std::cout << cmd.mb_str() << std::endl;
            wxExecute( cmd );
        }
        
    }
    
    DECLARE_EVENT_TABLE()
};

BEGIN_EVENT_TABLE(MyFrame, wxFrame)
EVT_BUTTON( ID_CONFIGURE, MyFrame::onConfigureClicked )
EVT_BUTTON( ID_LAUNCH,    MyFrame::onLaunchClicked )
END_EVENT_TABLE()

class MyApp: public wxApp
{
public:
    virtual bool OnInit();
    
    virtual void MacOpenFile(const wxString &filename)
    {
        wxString cmd = wxT("\"") + wxStandardPaths::Get().GetResourcesDir() + wxT("/../MacOS/mupen64plus\" --nogui \"") + filename + wxT("\"");
        std::cout << cmd.mb_str() << std::endl;
        wxExecute( cmd );
    }
};


IMPLEMENT_APP(MyApp)


bool MyApp::OnInit()
{
    wxInitAllImageHandlers();
    MyFrame* frame = new MyFrame(NULL, wxID_ANY,  wxT("Mupen 64 Plus beta launcher"), wxDefaultPosition, wxSize(750,480));
	
    return true;
}
}}}

This code can be built with something like
{{{
g++ launcher.cpp `wx-config --cxxflags --libs` -o launcher
}}}

HTML File : Put in /Contents/Resources/beta_msg.htm
{{{
<html>
<body>

<h2><center>Mupen64Plus on mac (beta)<br/>Instructions <font color="red">(very important)</font></center></h2>

<p>
Mupen64Plus is not yet fully functional on mac. While you should be able to use it to play games as well as on other platforms for the most part (only intel macs are supported), there are problems when launching a N64 ROM from the regular user interface.
</p>

<h4><center>How to use</center></h4>
<list>
<li/> Install <b>GTK+</b> from the following URL : <u>http://www.gtk-osx.org/</u>
<li/> To <b>configure</b> mupen64plus, or otherwise access its regular user interface, click on the <i>configure mupen64plus</i> button. You will namely want to do this first before playing any game to configure your controls (use the <i>options</i> menu). <b>However</b>, do <b>not</b> try to open ROMS from this interface - if you do, the game won't run properly. When you're done configuring, simply quit the user interface and come back to this launcher.
<li/> To actually <b>run a game</b>, you can simply <b>double-click it in the finder</b> (if the file is correctly associated with mupen). You can also drop roms on the mupen icon in the dock. Another possibility is to use the <b>play rom</b> button.
</list>

<p>
Hope you enjoy this early port to the mac!
</p>

</body>
</html>
}}}